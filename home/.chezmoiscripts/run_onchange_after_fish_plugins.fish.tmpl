#!/usr/bin/env fish

# fisher_plugins hash: {{ include (joinPath .chezmoi.sourceDir "dot_config" "fish" "fish_plugins.tmpl") | sha256sum }}

{{- $hash := "" -}}
{{- range (list "completions" "conf.d" "functions" "themes") -}}
  {{- $dir := printf "%s/dot_config/fish/%s" $.chezmoi.sourceDir . -}}
  {{- range (glob (printf "%s/*.fish" $dir)) -}}
    {{- $hash = printf "%s%s" $hash (include . | sha256sum) -}}
  {{- end -}}
{{- end }}
# fish plugin hash: {{ sha256sum $hash }}

if type -q fisher
    fisher update
else
    echo 'Skipping fisher update: fisher not installed.'
end

if type -q tide
    configure_tide_prompt
else
    echo 'Skipping Tide configuration: tide fish plugin not installed.'
end
